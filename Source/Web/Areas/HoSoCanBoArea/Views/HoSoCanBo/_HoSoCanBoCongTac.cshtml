@model Web.Areas.HoSoCanBoArea.Models.HoSoCanBoChiTietVM
<style>
#ThongTinCanBoCongTac td {
   padding: 5px;
}
 #detailCanBoCongTac span {
        white-space: pre-line !important;
    }
 #FormEditCanBoCongTac td {
        padding: 5px;
    }
</style>
<p dir="ltr" class="pt-Normal-000010">
    <span lang="en-GB" class="pt-DefaultParagraphFont-000001">28) Tóm tắt quá trình công tác</span>
    <a href="javascript:createThongTinCongTacCanBo()">
        <i class="fa fa-plus"></i>Thêm mới
    </a>
</p>
<div align="left">
    <table dir="ltr" class="pt-000004" id="detailCanBoCongTac">
        <tbody>
            <tr>
                <td class="pt-000020">
                    <p dir="ltr" class="pt-Normal-000008">
                        <span lang="en-GB" class="pt-DefaultParagraphFont-000001"> Từ tháng, năm - đến tháng, năm</span>
                    </p>
                </td>
                <td class="pt-000021">
                    <p dir="ltr" class="pt-Normal-000008">
                        <span lang="en-GB" class="pt-DefaultParagraphFont-000001"> Chức danh, chức vụ, đơn vị công tác (đảng, chính quyền, đoàn thể, tổ chức xã hội), kể cả thời gian được đào tạo, bồi dưỡng về chuyên môn, nghiệp vụ,......</span>
                    </p>
                </td>
            </tr>
            @foreach (var item in Model.ThongTinChung.HOSO_CANBO_CONGTAC)
            {
                <tr>
                    <td class="pt-000026">
                        <p dir="ltr" class="pt-Normal-000006">
                            <span xml:space="preserve" class="pt-000007" id="THOIGIANCONGTAC_@item.ID">
                            @item.THOIGIANCONGTAC
                        </span>
                        </p>
                    </td>
                    <td class="pt-000029">
                        <p dir="ltr" class="pt-Normal-000006">
                            <span xml:space="preserve" class="pt-000007" id="CHUCDANHDONVI_@item.ID">
                                @item.CHUCDANHDONVI
                            </span>
                            <a href="javascript:editCanBoCongTacRow(@item.ID)">
                                <i class="fa fa-edit"></i>
                            </a>
                            <a href="javascript:removeCanBoCongTacRow(@item.ID)">
                                <i class="fa fa-remove"></i>
                            </a>
                        </p>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<div class="modal fade" role="dialog" id="ThongTinCanBoCongTac">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"><strong>Tóm Tắt Quá Trình Cán Bộ Công Tác</strong></h4>
            </div>
            <div class="modal-body">
                <form id="FormDaoCanBoCongTac" action="/HoSoCanBoArea/HoSoCanBo/SaveThongTinCanBoCongTac" method="post">
                    <input type="hidden" name="HOSOID" value="@Model.ThongTinChung.ID" />
                    <table class="hinet-table table-bordered" id="table-canbo-congtac">
                        <tr>
                            <td>
                                Từ tháng, năm - đến tháng, năm
                            </td>
                            <td>
                                Chức danh, chức vụ, đơn vị công tác (đảng, chính quyền, đoàn thể, tổ chức xã hội), kể cả thời gian được đào tạo, bồi dưỡng về chuyên môn, nghiệp vụ,......
                            </td>
                            <td>
                                <a href="javascript:addNewRow()">
                                    <i class="fa fa-plus"></i>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="text" name="THOIGIANCONGTAC" class="required form-control " />
                                <div class="note-error ">
                                    <span class="error mes-note-error"></span>
                                </div>
                            </td>
                            <td>
                                <input type="text" name="CHUCDANHDONVI" class="required form-control" />
                                <div class="note-error">
                                    <span class="error mes-note-error"></span>
                                </div>
                            </td>
                            <td>
                                <a href="javascript:void(0)" class="removeRow">
                                    <i class="fa fa-remove"></i>
                                </a>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="saveCanBoCongTac('FormDaoCanBoCongTac')">Lưu</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" role="dialog" id="editThongTinCanBoCongTac">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"><strong>Tóm Tắt Quá Trình Cán Bộ Công Tác</strong></h4>
            </div>
            <div class="modal-body">
                <form id="FormEditCanBoCongTac" action="/HoSoCanBoArea/HoSoCanBo/SaveThongTinCanBoCongTac" method="post">
                    <input type="hidden" name="HOSOID" value="@Model.ThongTinChung.ID" />
                    <input type="hidden" name="DAOTAO_ID" id="DAOTAO_ID" />
                    <table class="hinet-table table-bordered">
                        <tr>
                            <td>
                                Từ tháng, năm - đến tháng, năm
                            </td>
                            <td>
                                Chức danh, chức vụ, đơn vị công tác (đảng, chính quyền, đoàn thể, tổ chức xã hội), kể cả thời gian được đào tạo, bồi dưỡng về chuyên môn, nghiệp vụ,......
                            </td>
                            <td>
                                <a href="javascript:addNewRow()">
                                    <i class="fa fa-plus"></i>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="text" name="THOIGIANCONGTAC" class="required form-control " />
                                <div class="note-error ">
                                    <span class="error mes-note-error"></span>
                                </div>
                            </td>
                            <td>
                                <input type="text" name="CHUCDANHDONVI" class="required form-control" />
                                <div class="note-error">
                                    <span class="error mes-note-error"></span>
                                </div>
                            </td>
                            <td>
                                <a href="javascript:void(0)" class="">
                                    <i class="fa fa-remove" style="display:none"></i>
                                </a>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="saveCanBoCongTac('FormEditCanBoCongTac')">Lưu</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<table style="display: none" id="HIDDENCANBOCONGTAC">
    <tr>
        <td>
            <input type="text" name="THOIGIANCONGTAC" class="required form-control " />
            <div class="note-error ">
                <span class="error mes-note-error"></span>
            </div>
        </td>
        <td>
            <input type="text" name="CHUCDANHDONVI" class="required form-control" />
            <div class="note-error">
                <span class="error mes-note-error"></span>
            </div>
        </td>
        <td>
            <a href="javascript:void(0)" class="removeRow">
                <i class="fa fa-remove"></i>
            </a>
        </td>
    </tr>
</table>
<script>
    function createThongTinCongTacCanBo() {
        $("#ThongTinCanBoCongTac").modal();
    }
    function addNewRow() {
        $("#table-canbo-congtac").append($("#HIDDENCANBOCONGTAC").html());
    }
    function editCanBoCongTacRow(id) {
        $("#editThongTinCanBoCongTac").modal();
        $("#editThongTinCanBoCongTac #DAOTAO_ID").val(id);
        $("#editThongTinCanBoCongTac input[name=THOIGIANCONGTAC]").val($("#THOIGIANCONGTAC_" + id).html().trim());
        $("#editThongTinCanBoCongTac input[name=CHUCDANHDONVI]").val($("#CHUCDANHDONVI_" + id).html().trim());
    }
    function removeCanBoCongTacRow(id) {
        $.confirm({
            'title': 'Xác nhận xử lý',
            'message': 'Bạn có chắc chắn muốn xóa thông tin cán bộ công tác, cán bộ công tác này?',
            'buttons': {
                'Đồng ý': {
                    'class': 'btn-confirm-yes btn-primary',
                    'action': function () {
                        $.ajax({
                            url: '/HoSoCanBoArea/HoSoCanBo/XoaCanBoCongTac',
                            type: 'post',
                            cache: false,
                            data: { id: id },
                            success: function (data) {
                                if (data.Type == "SUCCESS") {
                                    NotiSuccess("Xóa thành công");
                                    setTimeout(location.reload(), 2000);
                                } else {
                                    NotiError(data.Message);
                                }

                            },
                            error: function (err) {
                                NotiError(err.responseText);
                            }
                        });
                    }
                },
                'Hủy bỏ': {
                    'class': 'btn-danger',
                    'action': function () { }	// Nothing to do in this case. You can as well omit the action property.
                }
            }
        });
    }
    function saveCanBoCongTac(formid) {
        var is_submit = onSubmit(formid);
        if (is_submit) {
            $("#" + formid).submit();
        } else {
            return false;
        }
    }
    function onSubmit(formid) {
        var err = 0;
        var require = requiredFieldForFormId(formid);
        if (!require) {
            err++;
        }

        if (err == 0) {
            return true;
        } else {
            NotiError("Bạn vui lòng điền đầy đủ thông tin");
            return false;
        }
    }
</script>